<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login</title>
    <link rel="stylesheet" href="css/login.css">
     <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div>
        <a href="index.html"><span class="material-symbols-outlined">
            arrow_back
        </span></a>
    </div>
    <form action="javascript:usercheck();" class="loginForm">
        <h3>로그인</h3>
        <div class="textForm">
            <input type="text" name="userId" id="userId" class="id" placeholder="아이디를 입력하세요.">
        </div>
        <div class="textForm">
            <input type="password" name="pwd" id="pwd" class="pw" placeholder="비밀번호를 입력하세요.">
        </div>
        <input type="submit" id="btn" value="로 그 인"><br>

       <div class="divider">
           <div class="border"></div> 또는 
           <div class="border-right"></div>
       </div>

        <a href="javascript:kakaoLogin();">
            <img src="images/kakao_login.png" alt="카카오계정 로그인" style="height: 50px; width: 250px;"/>
        </a>
    </form>  

    <script>

        function usercheck(){
            const userVal = userId.value;
            const pwVal = pwd.value;
            // document.write(pwVal);

            const userList = JSON.parse(localStorage.getItem("userSets"));
            // console.log(userList);
        
        for(let i in userList){
            if((userList[i].userId === userVal) && (userList[i].pwd === pwVal)){
                alert("로그인 되었습니다!");
                window.location.href="index.html";
                return true;
                
            }
            alert("아이디 또는 패스워드를 확인하세요.");
            return false;
        }
    }
    </script>

    <!-- <script>
        document.querySelector("#btn").addEventListener("click", () => {

        const id = "admin";
        const password = "1234";
 
        if(id == document.querySelector("#userId").value) {
            if(password == document.querySelector("#pwd").value) {
                alert("환영합니다!");

        }
        else {
            alert("비밀번호가 맞지 않습니다.");      
        }
    }
    else {
        alert("아이디 혹은 비밀번호가 맞지 않습니다.");  
    }

});
    </script> -->

        <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
        <script>
            function saveToDos(token) { //item을 localStorage에 저장 
            typeof(Storage) !== 'undefined' && sessionStorage.setItem('AccessKEY', JSON.stringify(token)); 
        };

            window.Kakao.init('6ae38539d54ac05cd17a932c4fd6c9bc');

            function kakaoLogin() {
            window.Kakao.Auth.login({
                scope: 'profile_nickname, profile_image, gender, age_range, birthday',
                success: function(response) {
                    saveToDos(response.access_token)  // 로그인 성공하면 사용자 엑세스 토큰 sessionStorage에 저장
                    window.Kakao.API.request({ // 사용자 정보 가져오기 
                        url: '/v2/user/me',
                        success: (res) => {
                            const kakao_account = res.kakao_account;
                            alert('로그인 되셨습니다.');
                            window.location.href='index.html'
                        }
                    });
                },
                fail: function(error) {
                    console.log(error);
                }
            });
        };

        const login = document.querySelector('#kakaoLogin');
        login.addEventListener('click', kakaoLogin);   
    </script>
<!-- 
<a href="#0" id="kakaoLogout">로그아웃</a> | 
<a href="#0" id="secession">탈퇴</a>

<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>

    window.Kakao.init('6ae38539d54ac05cd17a932c4fd6c9bc');
    window.Kakao.Auth.setAccessToken(JSON.parse(sessionStorage.getItem('AccessKEY'))); //sessionStorage에 저장된 사용자 엑세스 토큰 받아온다.
    
    function kakaoLogout() {
        if (!Kakao.Auth.getAccessToken()) {
            console.log('Not logged in.');
            return;
        }
        Kakao.Auth.logout(function(response) {
            alert(response +' logout');
            window.location.href='/'
        });
    };

    function secession() {
        Kakao.API.request({
            url: '/v1/user/unlink',
            success: function(response) {
                console.log(response);
                //callback(); //연결끊기(탈퇴)성공시 서버에서 처리할 함수
                window.location.href='/'
            },
            fail: function(error) {
                console.log('탈퇴 미완료')
                console.log(error);
            },
        });
    };

    const logout = document.querySelector('#kakaoLogout');
    const sion = document.querySelector('#secession');

    logout.addEventListener('click', kakaoLogout);
    sion.addEventListener('click', secession);

    
    </script>  -->
</body>
</html>